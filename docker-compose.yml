version: '2'
services:
  # app:
  #   build: .
  #   container_name: "app"
  #   image: debian/latest
  #   environment:
  #       - ENVIRONMENT=production
  #   links:
  #       - postgres
  #   depends_on:
  #       - postgres
  #   ports:
  #     - '5000:5000'
  #   networks:
  #     - network1

  # celery:
  #   build: .
  #   command: celery -A app worker -l info
  # https://www.distributedpython.com/2018/10/13/flower-docker/
  flower:
    image: mher/flower
    environment:
    - CELERY_BROKER_URL=redis://redis
    - FLOWER_PORT=8888
    ports:
      - 8888:8888
    networks:
      - network1
  redis:
    hostname: redis
    image: redis:latest
    ports:
        - 6378:6379
    networks:
      - network1
  postgres:
    image: postgres:11
    environment:
      - POSTGRES_DB=anhd
      - POSTGRES_USER=anhd
    ports:
      - 5678:5432
    networks:
      - network1
volumes:
  pg_vol1:
networks:
  network1:
